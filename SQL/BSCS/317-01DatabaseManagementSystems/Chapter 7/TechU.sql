DROP TABLE TECHU_STUDENT CASCADE CONSTRAINTS;
DROP TABLE INSTRUCTOR CASCADE CONSTRAINTS;
DROP TABLE CLASS CASCADE CONSTRAINTS;
DROP TABLE TEST CASCADE CONSTRAINTS;
DROP TABLE TEST_RESULT CASCADE CONSTRAINTS;

CREATE TABLE TECHU_STUDENT (
   StudentID NUMBER PRIMARY KEY,
   FirstName VARCHAR2(50) NOT NULL,
   LastName VARCHAR2(50) NOT NULL
);

CREATE TABLE INSTRUCTOR (
   InstructorID NUMBER PRIMARY KEY,
   LastName VARCHAR2(50) NOT NULL,
   FirstName VARCHAR2(50) NOT NULL
);

CREATE TABLE CLASS (
   ClassID NUMBER PRIMARY KEY,
   ClassCode VARCHAR2(10) NOT NULL,
   ClassName VARCHAR2(100) NOT NULL,
   InstructorID NUMBER,
   FOREIGN KEY (InstructorID) REFERENCES INSTRUCTOR(InstructorID)
);

CREATE TABLE TEST (
   TestID NUMBER PRIMARY KEY,
   TestProvider VARCHAR2(100) NOT NULL,
   TestName VARCHAR2(100) NOT NULL
);

CREATE TABLE TEST_RESULT (
   ResultID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
   StudentID NUMBER NOT NULL,
   TestID NUMBER NOT NULL,
   ClassID NUMBER NOT NULL,
   DateTestTaken DATE NOT NULL,
   Pass_Fail VARCHAR2(1) NOT NULL,
   PRIMARY KEY (ResultID),
   FOREIGN KEY (StudentID) REFERENCES TECHU_STUDENT(StudentID),
   FOREIGN KEY (TestID) REFERENCES TEST(TestID),
   FOREIGN KEY (ClassID) REFERENCES CLASS(ClassID)
);

INSERT INTO TECHU_STUDENT (StudentID, FirstName, LastName) VALUES (123456, 'Fleming', 'Keaton');
INSERT INTO TECHU_STUDENT (StudentID, FirstName, LastName) VALUES (234567, 'Atkins', 'Anabella');
INSERT INTO TECHU_STUDENT (StudentID, FirstName, LastName) VALUES (293845, 'Wong', 'Sierra');
INSERT INTO TECHU_STUDENT (StudentID, FirstName, LastName) VALUES (345678, 'Maynard', 'Itzel');
INSERT INTO TECHU_STUDENT (StudentID, FirstName, LastName) VALUES (456789, 'Kennedy', 'Lane');
INSERT INTO TECHU_STUDENT (StudentID, FirstName, LastName) VALUES (567891, 'Bridges', 'Sanaa');
INSERT INTO TECHU_STUDENT (StudentID, FirstName, LastName) VALUES (876543, 'Santiago', 'Macie');

INSERT INTO INSTRUCTOR (InstructorID, LastName, FirstName) VALUES (125425, 'Gonzales', 'Maverick');
INSERT INTO INSTRUCTOR (InstructorID, LastName, FirstName) VALUES (254236, 'Rowland', 'Mary');
INSERT INTO INSTRUCTOR (InstructorID, LastName, FirstName) VALUES (369758, 'Holmes', 'Mia');
INSERT INTO INSTRUCTOR (InstructorID, LastName, FirstName) VALUES (412569, 'McKay', 'Luis');
INSERT INTO INSTRUCTOR (InstructorID, LastName, FirstName) VALUES (425687, 'Taylor', 'Brandon');

INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (1000, 'COM1000', 'Introduction to Computers', 254236);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (1001, 'COM1000', 'Introduction to Computers', 425687);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (2000, 'COM2000', 'Introduction to Operating Systems', 369758);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (2001, 'COM2000', 'Introduction to Operating Systems', 412569);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (2002, 'COM2000', 'Introduction to Operating Systems', 425687);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (3000, 'COM3000', 'Advanced Operating Systems', 254236);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (3001, 'COM3000', 'Advanced Operating Systems', 412569);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (3002, 'COM3000', 'Advanced Operating Systems', 425687);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (2100, 'NET2000', 'Introduction to Networking', 412569);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (2101, 'NET2000', 'Introduction to Networking', 369758);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (2102, 'NET2000', 'Introduction to Networking', 412569);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (3100, 'NET3000', 'Advanced Networking', 412569);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (3101, 'NET3000', 'Advanced Networking', 254236);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (3102, 'NET3000', 'Advanced Networking', 369758);
INSERT INTO CLASS (ClassID, ClassCode, ClassName, InstructorID) VALUES (3103, 'NET3000', 'Advanced Networking', 412569);

INSERT INTO TEST (TestID, TestProvider, TestName) VALUES (1, 'CompTIA', 'A+');
INSERT INTO TEST (TestID, TestProvider, TestName) VALUES (2, 'Cisco', 'CCNA');
INSERT INTO TEST (TestID, TestProvider, TestName) VALUES (3, 'Microsoft MCSA', 'MCSA');
INSERT INTO TEST (TestID, TestProvider, TestName) VALUES (4, 'Microsoft', 'MCSE');
INSERT INTO TEST (TestID, TestProvider, TestName) VALUES (5, 'CompTIA', 'Network+');
INSERT INTO TEST (TestID, TestProvider, TestName) VALUES (6, 'CompTIA Network+', 'Network+');

INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (234567, 1, 1000, TO_DATE('5/1/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (345678, 1, 1000, TO_DATE('5/1/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (123456, 1, 1001, TO_DATE('5/1/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (456789, 1, 1001, TO_DATE('5/1/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (293845, 2, 2000, TO_DATE('8/15/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (345678, 2, 2001, TO_DATE('8/15/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (456789, 2, 2002, TO_DATE('8/15/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (293845, 3, 3000, TO_DATE('9/1/2020', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (345678, 3, 3000, TO_DATE('3/1/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (345678, 3, 3001, TO_DATE('9/1/2020', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (456789, 3, 3002, TO_DATE('9/1/2020', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (456789, 3, 3002, TO_DATE('3/1/2020', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (456789, 4, 2100, TO_DATE('5/1/2021', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (456789, 4, 2100, TO_DATE('8/15/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (876543, 4, 2100, TO_DATE('8/15/2021', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (234567, 4, 2101, TO_DATE('5/1/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (567891, 4, 2101, TO_DATE('8/15/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (345678, 4, 2102, TO_DATE('5/1/2021', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (345678, 4, 2102, TO_DATE('8/15/2021', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (123456, 5, 3100, TO_DATE('3/1/2020', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (123456, 5, 3100, TO_DATE('9/15/2020', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (345678, 5, 3101, TO_DATE('3/1/2020', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (234567, 5, 3102, TO_DATE('3/1/2020', 'MM/DD/YYYY'), 'P');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (567891, 5, 3102, TO_DATE('3/1/2020', 'MM/DD/YYYY'), 'F');
INSERT INTO TEST_RESULT (StudentID, TestID, ClassID, DateTestTaken, Pass_Fail) VALUES (456789, 5, 3103, TO_DATE('3/1/2020', 'MM/DD/YYYY'), 'P');


/*

SELECT s.LastName, s.FirstName, t.TestName, tr.DateTestTaken, tr.Pass_Fail
FROM TECHU_STUDENT s
JOIN TEST_RESULT tr ON s.StudentID = tr.StudentID
JOIN TEST t ON tr.TestID = t.TestID
ORDER BY s.LastName, s.FirstName, t.TestName;

SELECT t.TestName, COUNT(*) AS TEST_Passed
FROM TEST_RESULT tr
JOIN TEST t ON tr.TestID = t.TestID
WHERE tr.Pass_Fail = 'P'
GROUP BY t.TestName;

*/